#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

// TODO: Skip 6th column of C5 chars
//
#define MAX_LINE_LEN 100
#define NUM_C5_CHARS 26
#define FULL_PAGE_SIZE (2+61*61)
#define NUM_ROWS 60
#define NUM_COLS 60
#define DISPLAY_NUM_COLS 61
#define CENTER_COL 30

#define C5_DISPLAY_WIDTH 6
#define C5_WIDTH 5
#define C5_HEIGHT 5

char line[MAX_LINE_LEN];

char page[FULL_PAGE_SIZE] = "\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
............................................................\n\
\n\
------------------------------------------------------------\n\
\n";


char* large_font[NUM_C5_CHARS] = {
".***.*...*******...**...*", // A
"****.*...*****.*...*****.", // B
".*****...**....*.....****", // C
"****.*...**...**...*****.", // D
"******....***..*....*****", // E
"******....***..*....*....", // F
".*****....*..***...*.***.", // G
"*...**...*******...**...*", // H
"*****..*....*....*..*****", // I
"..***...*....*.*..*..**..", // J
"*...**..*.***..*..*.*...*", // K
"*....*....*....*....*****", // L
"*...***.***.*.**...**...*", // M
"*...***..**.*.**..***...*", // N
".***.*...**...**...*.***.", // O
"****.*...*****.*....*....", // P
".***.*...**...**..**.****", // Q
"****.*...*****.*..*.*...*", // R
".*****.....***.....*****.", // S
"******.*.*..*....*...***.", // T
"*...**...**...**...*.***.", // U
"*...**...*.*.*..*.*...*..", // V
"*...**...**.*.***.***...*", // W
"*...*.*.*...*...*.*.*...*", // X
"*...*.*.*...*....*....*..", // Y
"*****...*...*...*...*****", // Z
};

void C1_print_at(int col, int row, char *text, int len) {
	if (row < NUM_ROWS) {
		if (col < 0) {
			text += -col;
			len  += col;
			col   = 0;
		}
		if (len>0) {
			int fit = NUM_COLS - col;
			if (len < fit) fit = len;
			for (int i=0;i<fit;++i)
				if (text[i]==' ')
					text[i]='.';
			memcpy(&page[col + row*DISPLAY_NUM_COLS],text,fit);
		}
	}
}

void C5_print_char_at(int col, int row, char c) {
	// how many cols can we fit?
	int cols_fit = C5_WIDTH,
		rem = NUM_COLS - col;
	if (rem < cols_fit)
		cols_fit = rem;
	// how many rows can we fit?
	int rows_fit = C5_HEIGHT;
	rem = NUM_ROWS - row;
	if (rem < rows_fit)
		rows_fit = rem;
	
	char *font = large_font[c - 'A'];
	for (int y = 0; y < rows_fit; ++y) {
		int pos = col + (y+row) * DISPLAY_NUM_COLS;
		for (int x = 0; x < cols_fit; ++x) {
			if (font[x]=='*')
				page[pos+x] = '*';
		}
		font += C5_WIDTH;
	}
}

void C5_print_at(int col, int row, char *text, int len) {
	if (row < NUM_ROWS) {
		for (int i=0,ccol=col
			;i<len && ccol<NUM_COLS
			;++i,ccol+=C5_DISPLAY_WIDTH) {

			char c = text[i];
			if (c != ' ') {
				C5_print_char_at(ccol,row,c);
			}
		}
	}
}

int main() {
	while (NULL != fgets(line,MAX_LINE_LEN,stdin)) {

		/*
		 * opcode
		 */
		char opcode = line[1],
			 tmpchar;

		if(opcode!='E') {
			char *ptr = & line[6];
			/*
			 * use_large_font : 0(use C1) 1(use C5)
			 */
			char use_large_font = line[4]=='5';

			/*
			 * row (row number)
			 */
			int row = *(ptr++) - '0';
			if ( (tmpchar=*(ptr++))!=' ') {
				row = row*10 + tmpchar - '0';
				++ptr;
			}
			-- row;

			char *terminator;
		   	for(terminator = line + strlen(line) - 1;*terminator!='|';--terminator)
				;
			*terminator = '\0';
			
			char *text;
			int text_len;

			switch(opcode) {
				case 'P': {
					int col = *(ptr++) - '0';
					if ( (tmpchar=*(ptr++))!=' ') {
						col = col*10 + tmpchar - '0';
						++ptr;
					}
					-- col;

					text = ++ptr;
					text_len = terminator - text;
					if (!use_large_font) {
						C1_print_at(col,row,text,text_len);
					}
					else {
						C5_print_at(col,row,text,text_len);
					}
				} break;

				case 'L':
					text = ++ptr;
					text_len = terminator - text;
					if (!use_large_font) {
						C1_print_at(0,row,text,text_len);
					}
					else {
						C5_print_at(0,row,text,text_len);
					}

					break;

				case 'R':
					text = ++ptr;
					text_len = terminator - text;
					if (!use_large_font) {
						C1_print_at(NUM_COLS-text_len,row,text,text_len);
					}
					else {
						C5_print_at(NUM_COLS-text_len,row,text,text_len);
					}
					break;

				case 'C':
					text = ++ptr;
					text_len = terminator - text;
					if (!use_large_font) {
						C1_print_at(CENTER_COL-(text_len>>1),row,text,text_len);
					}
					else {
						C5_print_at(CENTER_COL-text_len,row,text,text_len);
					}

					break;
			}

		}
		else {
			write(1,page,sizeof(page));
		}
	}
	return 0;
}

